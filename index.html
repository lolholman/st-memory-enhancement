<div class="translation_settings">
    <div class="inline-drawer">
        <div class="inline-drawer-toggle inline-drawer-header">
            <div><b>Memory Enhancement (Table)</b><span id="tableUpdateTag">Update Available</span></div>
            <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
        </div>
        <div class="inline-drawer-content">
            <!-- Memory Enhancement Table Management -->
            <div id="table_message_tip"></div>
            <div style=" display: flex;">
                <div class="menu_button">
                    <i class="fa-solid fa-window-restore"></i>
                    <a href="https://muyoo.com.cn/2025/01/26/SillyTavern%E9%85%92%E9%A6%86%E8%AE%B0%E5%BF%86%E5%A2%9E%E5%BC%BA%E6%8F%92%E4%BB%B6%E6%95%99%E7%A8%8B/">Read Tutorial</a>
                </div>
                <div class="menu_button">
                    <i class="fa-solid fa-window-restore"></i>
                    <a href="https://muyoo.com.cn/2025/01/27/SillyTavern%E9%85%92%E9%A6%86%E8%AE%B0%E5%BF%86%E5%A2%9E%E5%BC%BA%E6%8F%92%E4%BB%B6%E6%9B%B4%E6%96%B0%E6%97%A5%E5%BF%97/">Changelog</a>
                </div>
            </div>

            <!-- Sub-settings -->
            <div style="padding: 10px 0; gap: 10px">
                <!-- Plugin Presets -->
                <div class="table_setting_category_container" style="display: flex; align-items: center; gap: 6px;">
                    <b class="table_setting_category_header">Import, Export & Reset Plugin</b><div style="height: 10px;"></div>
                    <div class="menu_button menu_button_icon fa-solid fa-file-import" id="table-set-import" title="Import Table Preset">
                    </div>
                    <input type="file" id="table-set-importFile" accept=".json" hidden>
                    <div class="menu_button menu_button_icon fa-solid fa-file-export" id="table-set-export" title="Export Table Preset">
                    </div>
                    <div class="menu_button menu_button_icon fa-solid fa-undo" id="table-reset" title="Reset Table Preset"></div>
                </div>
                <hr/>

                <!-- Basic Settings -->
                <div class="table_setting_category_container">
                    <b class="table_setting_category_header">Basic Settings</b><div style="height: 10px;"></div>
                    <div class="checkbox flex-container">
                        <input type="checkbox" id="table_switch"><span>Enable Plugin</span>
                    </div>
                    <div class="checkbox flex-container">
                        <input type="checkbox" id="table_read_switch"><span>AI Table Reading</span>
                    </div>
                    <div class="checkbox flex-container">
                        <input type="checkbox" id="table_edit_switch"><span>AI Table Editing</span>
                    </div>
                </div>
                <hr/>

                <!-- Table Presets -->
                <div class="table_setting_category_container">
                    <b class="table_setting_category_header">Response Settings</b><div style="height: 10px;"></div>
                    <div style="padding-left: 10px;">
                        <label for="dataTable_injection_mode" class="checkbox_label">Injection Settings</label>
                        <div style=" display: flex;">
                            <select id="dataTable_injection_mode">
                                <option value="injection_off">Disable Injection</option>
                                <option value="deep_system">@D âš™</option>
                                <option value="deep_user">@D ðŸ‘¤</option>
                                <option value="deep_assistant">@D ðŸ¤–</option>
                            </select>
                            <label style="min-width: 60px; padding-left: 10px; " for="dataTable_deep">Depth:</label>
                            <input class="text_pole wideMax100px margin0" type="number" id="dataTable_deep"></input>
                        </div>
                    </div>
                    <div style="padding-left: 10px;">
                        <label for="dataTable_message_template">Message Template</label><small>
                        (Used to instruct AI on how to use and modify tables, use <code>{{tableData}}</code> macro to specify where to insert table data)</small>
                        <textarea id="dataTable_message_template" class="wide100p" rows="5"></textarea>
                    </div>
                </div>
                <hr/>

                <!-- Reorganize Table -->
                <div class="table_setting_category_container">
                    <b class="table_setting_category_header">Reorganize Table</b><div style="height: 10px;"></div>
                    <div class="checkbox flex-container">
                        <input type="checkbox" id="advanced_settings">
                        <span>View Advanced Settings</span>
                    </div>
                    <div id="advanced_options" style="display: none; padding-left: 20px; width: calc(100% - 20px);">
                        <!-- Advanced Settings Options -->
                        <div class="flex-container slider-container" style="margin: 5px 0 5px 20px; width: 90%;">
                            <label>Reference Message Count (Recent messages to consider): <span id="clear_up_stairs_value">3</span></label>
                            <input type="range" id="clear_up_stairs" min="3" max="20" step="1" value="3" style="width: 80%;">
                        </div>
                        <div class="flex-container slider-container" style="margin: 5px 0 5px 20px; width: 90%;">
                            <label>API Temperature Setting (Only applies to custom API): <span id="custom_temperature_value">1.0</span></label>
                            <input type="range" id="custom_temperature" min="0.1" max="2.0" step="0.1" value="1.0" style="width: 80%;">
                        </div>
                        <div style="height: 20px;"></div>
                        <div class="checkbox flex-container" style="margin-left: 10px; width: 100%;">
                            <input type="checkbox" id="ignore_del" checked>
                            <span>Only modify and add during reorganization, do not delete</span>
                        </div>

                        <!-- Custom API -->
                        <div class="checkbox flex-container" style="margin-left: 10px; width: 100%;">
                            <input type="checkbox" id="use_main_api" checked>
                            <span>Use Main API (Uncheck to use custom API)</span>
                        </div>
                        <div id="custom_api_settings" style="display: none; flex-direction: column; gap: 5px; margin-top: 10px;">
                            <!-- Custom API Settings -->
                            <input type="text" id="custom_api_url" class="text_pole" placeholder="API URL (must end with /v1)">
                            <input type="password" id="custom_api_key" class="text_pole" placeholder="API Key">
                            <input type="text" id="custom_model_name" class="text_pole" placeholder="Model Name">
                            <div style="margin-top: 10px;">
                                <select id="model_selector" class="text_pole" style="width: 100%; margin-bottom: 5px;">
                                    <option value="">Please fetch model list first</option>
                                </select>
                                <div class="menu_button" id="fetch_models_button" style="width: 100%;">
                                    <a>Fetch Model List</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="menu_button" id="table_clear_up" style="min-width: 120px;">
                        <i class="fa-solid fa-arrows-rotate"></i><a>Reorganize Table</a>
                    </div>
                </div>
                <hr/>

                <!-- Push Table to Chat -->
                <div class="table_setting_category_container">
                    <b class="table_setting_category_header">Push Table to Chat</b><div style="height: 10px;"></div>
                    <div class="checkbox flex-container">
                        <input type="checkbox" id="table_to_chat"><span>Push Table to Chat</span>
                    </div>
                    <div class="menu_button" id="dataTable_to_chat_button">
                        <i class="fa-solid fa-pen-to-square"></i><a style="min-width: 100px">Edit Chat Panel Style</a>
                    </div>
                </div>
                <hr/>

                <div class="table_setting_category_container"><!-- Table Structure -->
                    <b class="table_setting_category_header">Table Structure</b><div style="height: 10px;"></div>
                    <div style="padding-left: 10px;">
                        <label>All Tables</label><small> (Currently used to modify table descriptions and various table operation trigger prompts)</small>
                        <div id="dataTable_tableEditor_list">
                        </div>
                    </div>
                </div>
            </div>

            <div style="height: 20px;"></div>
        </div>
    </div>
</div>
